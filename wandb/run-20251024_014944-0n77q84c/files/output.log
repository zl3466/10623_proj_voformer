  0%|                                                                                                                                                                                  | 0/1860 [00:00<?, ?it/s]
Number of input images: 9
Pose prompt: Given the following input poses: translation(43.662, 53.287, 0.486) translation(43.994, 53.813, 0.478) translation(44.163, 54.079, 0.474) translation(44.505, 54.617, 0.466) translation(44.847, 55.165,...
Processed pixel_values shape: torch.Size([2916, 1176])
Processed input_ids shape: torch.Size([1, 635])
Data collator - pixel_values shape: torch.Size([1, 2916, 1176])
Data collator - input_ids shape: torch.Size([1, 1, 635])
Data collator - labels shape: torch.Size([1, 1, 635])
Number of input images: 9
Pose prompt: Given the following input poses: translation(16.074, 14.902, 1.149) translation(16.399, 15.409, 1.140) translation(16.716, 15.902, 1.130) translation(16.878, 16.151, 1.126) translation(17.202, 16.650,...
Processed pixel_values shape: torch.Size([2916, 1176])
Processed input_ids shape: torch.Size([1, 635])
Data collator - pixel_values shape: torch.Size([1, 2916, 1176])
Data collator - input_ids shape: torch.Size([1, 1, 635])
Data collator - labels shape: torch.Size([1, 1, 635])
{'pixel_values': tensor([[[ 0.5581,  0.5727,  0.6165,  ...,  1.0367,  1.0225,  1.1221],
         [ 0.5143,  0.5289,  0.5435,  ..., -0.9256, -0.8688, -0.7550],
         [ 0.6019,  0.6019,  0.6019,  ...,  1.1221,  1.1078,  1.1363],
         ...,
         [-0.3324, -0.3762, -0.3762,  ..., -0.2146, -0.2573, -0.2004],
         [-0.3178, -0.3178, -0.3470,  ..., -0.2004, -0.1435, -0.1293],
         [-0.4054, -0.4200, -0.4346,  ..., -0.2573, -0.2573, -0.2004]]],
       device='cuda:0'), 'input_ids': tensor([[[22043,   279,  2701,  1946, 33003,    25, 14468,     7,    19,    18,
             13,    21,    21,    17,    11,   220,    20,    18,    13,    17,
             23,    22,    11,   220,    15,    13,    19,    23,    21,     8,
          14468,     7,    19,    18,    13,    24,    24,    19,    11,   220,
             20,    18,    13,    23,    16,    18,    11,   220,    15,    13,
             19,    22,    23,     8, 14468,     7,    19,    19,    13,    16,
             21,    18,    11,   220,    20,    19,    13,    15,    22,    24,
             11,   220,    15,    13,    19,    22,    19,     8, 14468,     7,
             19,    19,    13,    20,    15,    20,    11,   220,    20,    19,
             13,    21,    16,    22,    11,   220,    15,    13,    19,    21,
             21,     8, 14468,     7,    19,    19,    13,    23,    19,    22,
             11,   220,    20,    20,    13,    16,    21,    20,    11,   220,
             15,    13,    19,    20,    24,     8, 14468,     7,    19,    20,
             13,    18,    20,    15,    11,   220,    20,    20,    13,    24,
             22,    18,    11,   220,    15,    13,    19,    20,    15,     8,
          14468,     7,    19,    20,    13,    21,    23,    20,    11,   220,
             20,    21,    13,    20,    15,    23,    11,   220,    15,    13,
             19,    19,    16,     8, 14468,     7,    19,    20,    13,    23,
             20,    20,    11,   220,    20,    21,    13,    22,    22,    22,
             11,   220,    15,    13,    19,    18,    23,     8, 14468,     7,
             19,    21,    13,    16,    24,    23,    11,   220,    20,    22,
             13,    18,    16,    20,    11,   220,    15,    13,    19,    18,
             16,   340, 53544,   279,  1790, 33003,    25, 14468,     7,    19,
             21,    13,    20,    19,    20,    11,   220,    20,    22,    13,
             23,    21,    21,    11,   220,    15,    13,    19,    17,    17,
              8, 14468,     7,    19,    21,    13,    22,    16,    20,    11,
            220,    20,    23,    13,    16,    19,    15,    11,   220,    15,
             13,    19,    16,    21,     8, 14468,     7,    19,    22,    13,
             15,    20,    23,    11,   220,    20,    23,    13,    21,    23,
             23,    11,   220,    15,    13,    19,    15,    21,     8, 14468,
              7,    19,    22,    13,    18,    24,    23,    11,   220,    20,
             24,    13,    17,    18,    19,    11,   220,    15,    13,    18,
             24,    23,     8, 14468,     7,    19,    22,    13,    20,    21,
             22,    11,   220,    20,    24,    13,    20,    16,    16,    11,
            220,    15,    13,    18,    24,    19,     8, 14468,     7,    19,
             22,    13,    24,    15,    16,    11,   220,    21,    15,    13,
             15,    20,    22,    11,   220,    15,    13,    18,    23,    21,
              8, 14468,     7,    19,    23,    13,    17,    17,    22,    11,
            220,    21,    15,    13,    20,    24,    17,    11,   220,    15,
             13,    18,    22,    24,     8, 14468,     7,    19,    23,    13,
             18,    24,    15,    11,   220,    21,    15,    13,    23,    20,
             23,    11,   220,    15,    13,    18,    22,    20,     8, 14468,
              7,    19,    23,    13,    22,    16,    21,    11,   220,    21,
             16,    13,    18,    24,    15,    11,   220,    15,    13,    18,
             21,    22,     8, 14468,     7,    19,    24,    13,    15,    19,
             24,    11,   220,    21,    16,    13,    24,    18,    23,    11,
            220,    15,    13,    18,    20,    24,     8, 14468,     7,    19,
             24,    13,    17,    16,    22,    11,   220,    21,    17,    13,
             17,    16,    16,    11,   220,    15,    13,    18,    20,    20,
              8, 14468,     7,    19,    24,    13,    20,    20,    20,    11,
            220,    21,    17,    13,    22,    20,    18,    11,   220,    15,
             13,    18,    19,    23,     8, 14468,     7,    19,    24,    13,
             23,    23,    23,    11,   220,    21,    18,    13,    17,    24,
             22,    11,   220,    15,    13,    18,    19,    16,     8, 14468,
              7,    20,    15,    13,    15,    20,    17,    11,   220,    21,
             18,    13,    20,    21,    18,    11,   220,    15,    13,    18,
             18,    22,     8, 14468,     7,    20,    15,    13,    18,    22,
             22,    11,   220,    21,    19,    13,    16,    15,    17,    11,
            220,    15,    13,    18,    17,    22,     8, 14468,     7,    20,
             15,    13,    22,    15,    19,    11,   220,    21,    19,    13,
             21,    19,    19,    11,   220,    15,    13,    18,    17,    15,
              8, 14468,     7,    20,    15,    13,    23,    21,    23,    11,
            220,    21,    19,    13,    24,    17,    15,    11,   220,    15,
             13,    18,    16,    21,     8]]], device='cuda:0'), 'labels': tensor([[[ -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,
           -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,  -100,
           -100,  -100,  -100,  -100,  -100,  -100,  -100,    23,    21,     8,
          14468,     7,    19,    18,    13,    24,    24,    19,    11,   220,
             20,    18,    13,    23,    16,    18,    11,   220,    15,    13,
             19,    22,    23,     8, 14468,     7,    19,    19,    13,    16,
             21,    18,    11,   220,    20,    19,    13,    15,    22,    24,
             11,   220,    15,    13,    19,    22,    19,     8, 14468,     7,
             19,    19,    13,    20,    15,    20,    11,   220,    20,    19,
             13,    21,    16,    22,    11,   220,    15,    13,    19,    21,
             21,     8, 14468,     7,    19,    19,    13,    23,    19,    22,
             11,   220,    20,    20,    13,    16,    21,    20,    11,   220,
             15,    13,    19,    20,    24,     8, 14468,     7,    19,    20,
             13,    18,    20,    15,    11,   220,    20,    20,    13,    24,
             22,    18,    11,   220,    15,    13,    19,    20,    15,     8,
          14468,     7,    19,    20,    13,    21,    23,    20,    11,   220,
             20,    21,    13,    20,    15,    23,    11,   220,    15,    13,
             19,    19,    16,     8, 14468,     7,    19,    20,    13,    23,
             20,    20,    11,   220,    20,    21,    13,    22,    22,    22,
             11,   220,    15,    13,    19,    18,    23,     8, 14468,     7,
             19,    21,    13,    16,    24,    23,    11,   220,    20,    22,
             13,    18,    16,    20,    11,   220,    15,    13,    19,    18,
             16,   340, 53544,   279,  1790, 33003,    25, 14468,     7,    19,
             21,    13,    20,    19,    20,    11,   220,    20,    22,    13,
             23,    21,    21,    11,   220,    15,    13,    19,    17,    17,
              8, 14468,     7,    19,    21,    13,    22,    16,    20,    11,
            220,    20,    23,    13,    16,    19,    15,    11,   220,    15,
             13,    19,    16,    21,     8, 14468,     7,    19,    22,    13,
             15,    20,    23,    11,   220,    20,    23,    13,    21,    23,
             23,    11,   220,    15,    13,    19,    15,    21,     8, 14468,
              7,    19,    22,    13,    18,    24,    23,    11,   220,    20,
             24,    13,    17,    18,    19,    11,   220,    15,    13,    18,
             24,    23,     8, 14468,     7,    19,    22,    13,    20,    21,
             22,    11,   220,    20,    24,    13,    20,    16,    16,    11,
            220,    15,    13,    18,    24,    19,     8, 14468,     7,    19,
             22,    13,    24,    15,    16,    11,   220,    21,    15,    13,
             15,    20,    22,    11,   220,    15,    13,    18,    23,    21,
              8, 14468,     7,    19,    23,    13,    17,    17,    22,    11,
            220,    21,    15,    13,    20,    24,    17,    11,   220,    15,
             13,    18,    22,    24,     8, 14468,     7,    19,    23,    13,
             18,    24,    15,    11,   220,    21,    15,    13,    23,    20,
             23,    11,   220,    15,    13,    18,    22,    20,     8, 14468,
              7,    19,    23,    13,    22,    16,    21,    11,   220,    21,
             16,    13,    18,    24,    15,    11,   220,    15,    13,    18,
             21,    22,     8, 14468,     7,    19,    24,    13,    15,    19,
             24,    11,   220,    21,    16,    13,    24,    18,    23,    11,
            220,    15,    13,    18,    20,    24,     8, 14468,     7,    19,
             24,    13,    17,    16,    22,    11,   220,    21,    17,    13,
             17,    16,    16,    11,   220,    15,    13,    18,    20,    20,
              8, 14468,     7,    19,    24,    13,    20,    20,    20,    11,
            220,    21,    17,    13,    22,    20,    18,    11,   220,    15,
             13,    18,    19,    23,     8, 14468,     7,    19,    24,    13,
             23,    23,    23,    11,   220,    21,    18,    13,    17,    24,
             22,    11,   220,    15,    13,    18,    19,    16,     8, 14468,
              7,    20,    15,    13,    15,    20,    17,    11,   220,    21,
             18,    13,    20,    21,    18,    11,   220,    15,    13,    18,
             18,    22,     8, 14468,     7,    20,    15,    13,    18,    22,
             22,    11,   220,    21,    19,    13,    16,    15,    17,    11,
            220,    15,    13,    18,    17,    22,     8, 14468,     7,    20,
             15,    13,    22,    15,    19,    11,   220,    21,    19,    13,
             21,    19,    19,    11,   220,    15,    13,    18,    17,    15,
              8, 14468,     7,    20,    15,    13,    23,    21,    23,    11,
            220,    21,    19,    13,    24,    17,    15,    11,   220,    15,
             13,    18,    16,    21,     8]]], device='cuda:0'), 'attention_mask': tensor([[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]]], device='cuda:0')}
Model inputs:
  pixel_values shape: torch.Size([1, 2916, 1176])
  input_ids shape: torch.Size([1, 1, 635])
  labels shape: torch.Size([1, 1, 635])
  attention_mask shape: torch.Size([1, 1, 635])
  File "/home/zl3466/Documents/cmu/10623/proj/train.py", line 123, in <module>
    main()
  File "/home/zl3466/Documents/cmu/10623/proj/train.py", line 118, in main
    trainer.train()
  File "/home/zl3466/Documents/cmu/10623/proj/src/vo_trainer.py", line 281, in train
    trainer.train()
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/transformers/trainer.py", line 2325, in train
    return inner_training_loop(
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/transformers/trainer.py", line 2674, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/transformers/trainer.py", line 4020, in training_step
    loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
  File "/home/zl3466/Documents/cmu/10623/proj/src/vo_trainer.py", line 40, in compute_loss
    outputs = model(**inputs)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zl3466/Documents/cmu/10623/proj/src/vo_model.py", line 45, in forward
    outputs = self.base_model(
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 1257, in forward
    image_embeds = self.get_image_features(pixel_values, image_grid_thw)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 1170, in get_image_features
    image_embeds = self.visual(pixel_values, grid_thw=image_grid_thw)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 418, in forward
    rotary_pos_emb = self.rot_pos_emb(grid_thw)
  File "/home/zl3466/anaconda3/envs/voformer/lib/python3.9/site-packages/transformers/models/qwen2_5_vl/modeling_qwen2_5_vl.py", line 338, in rot_pos_emb
    for t, h, w in grid_thw:
TypeError: 'NoneType' object is not iterable
